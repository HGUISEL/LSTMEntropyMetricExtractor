 import org.apache.hadoop.fs.FileStatus;
  private long lastModified = 0;
    FileStatus stat = crawlDbPath.getFileSystem(config).getFileStatus(crawlDbPath);
    long lastModified = stat.getModificationTime();
    synchronized (this) {
      if (readers != null) {
        if (this.lastModified == lastModified) {
          // CrawlDB not modified, re-use readers
          return;
        } else {
          // CrawlDB modified, close and re-open readers
          closeReaders();
        }
      }
      this.lastModified = lastModified;
      readers = MapFileOutputFormat.getReaders(crawlDbPath, config);
    }
 import org.apache.hadoop.fs.FileStatus;
  private long lastModified = 0;
  public void openReaders() throws IOException {
    Path linkDbPath = new Path(directory, LinkDb.CURRENT_NAME);
    FileStatus stat = linkDbPath.getFileSystem(getConf()).getFileStatus(directory);
    long lastModified = stat.getModificationTime();
    synchronized (this) {
      if (readers != null) {
        if (this.lastModified == lastModified) {
          // CrawlDB not modified, re-use readers
          return;
        } else {
          // CrawlDB modified, close and re-open readers
          close();
        }
      }
      this.lastModified = lastModified;
      readers = MapFileOutputFormat.getReaders(linkDbPath, getConf());
    }
  }
    openReaders();
        output.append("\n");
